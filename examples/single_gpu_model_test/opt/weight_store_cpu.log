<run_flexgen>: args.model: facebook/opt-125m
model size: 0.230 GB, cache size: 0.040 GB, hidden size (prefill): 0.002 GB
init weight...
start create model 
split sizes  [768]
split sizes  [768]
split sizes  [768]
split sizes  [768]
split sizes  [768]
split sizes  [768]
split sizes  [768]
split sizes  [768]
split sizes  [768]
split sizes  [768]
split sizes  [768]
split sizes  [768]
init all weights 
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
-------------------before weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
-----------------------------after weight_home.store(weights) {'VmPeak': 30810.18359375, 'VmSize': 30704.54296875, 'VmHWM': 10096.08984375, 'VmRSS': 10022.44921875}
******* OPTLM model init weight
******* OPTLM model init weight
the time init all weights  5.27946925163269
the model construction time  5.38848876953125
   model structure 
InputEmbed
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
SelfAttention
prefill  None
MLP
OutputEmbed

the useful data start from here -------------------------------------
benchmark - generate
args.gen_len  32
input  torch.Size([4, 256])
============ generate loop normal ============
generate start -----
++++++++++++------+++++ compute_layer  layer   0
------------------------layer name  InputEmbed
hidden  TorchTensor(shape=torch.Size([4, 256, 768]), dtype=torch.float16, device=cuda:0)
++++++++++++------+++++ compute_layer  layer   1
